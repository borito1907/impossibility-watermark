/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/transformers/utils/hub.py:124: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
CUDA extension not installed.
CUDA extension not installed.
[nltk_data] Downloading package punkt to /home/borito1907/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[2024-05-31 03:20:10,160][__main__][INFO] - Starting to watermark...
[2024-05-31 03:20:10,162][__main__][INFO] - Prompt: Write a paragraph analyzing the role of symbolism in "To Kill a Mockingbird" and its impact on understanding the novel's themes.
[2024-05-31 03:20:10,163][__main__][INFO] - Getting the watermarker...
[2024-05-31 03:20:10,163][watermarker][INFO] - Using device: cuda
[2024-05-31 03:20:10,163][model_builders.pipeline][INFO] - Initializing TheBloke/Mixtral-8x7B-Instruct-v0.1-GPTQ
/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/transformers/modeling_utils.py:4371: FutureWarning: `_is_quantized_training_enabled` is going to be deprecated in transformers 4.39.0. Please use `model.hf_quantizer.is_trainable` instead
  warnings.warn(
[2024-05-31 03:20:11,953][accelerate.utils.modeling][INFO] - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/langchain_core/_api/deprecation.py:119: LangChainDeprecationWarning: The class `HuggingFacePipeline` was deprecated in LangChain 0.0.37 and will be removed in 0.3. An updated version of the class exists in the from rom langchain-huggingface package and should be used instead. To use it run `pip install -U from rom langchain-huggingface` and import as `from from rom langchain_huggingface import llms import HuggingFacePipeline`.
  warn_deprecated(
[2024-05-31 03:20:25,027][__main__][INFO] - Got the watermarker. Generating watermarked text...
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[2024-05-31 03:28:09,112][watermarker][INFO] - Received completion: Write a paragraph analyzing the role of symbolism in "To Kill a Mockingbird" and its impact on understanding the novel's themes.Symbolism holds immense significance in To Kill a Mockingbird as a literary technique interlaced skillfully by writer Harper Lee throughout the narrative, which deep-rooted essential aspects that allow thorough understandings concerning racial prejudices, judicial bias and moral development present within Maycomb county society during the early 1930s. The mockingbird serves as an embodiment symbolizing innocent victims whose lives or societal standers take unwarranted negative drifts due to inherent evil forces target innocent souls devoid of intentional wrongdoings in this intricate Southern backdrop steeped rich in historical segregation woes explicated poignantly. Another example is when Jem loses faith and hope following Tom Robinson's tragic demise while Boo Radley transformively alters her misconceptions through his hidden humanity underneath an underrated characterization shrouded ominously for reasons never truly clarified conclusively but interpreted alternatively differently with the reader perceptions and ability readdress predisposed conclusions surrounding unfamiliar people they once harshly judged before having meaningful connections thereby promoting tolerance ultimately towards marginalized underprivileged individuals needing their unbiased support unequivocally endlessly despite inevitable external criticism pressurised relentlessly negate one's virtuous efforts tirelessly battling against systemic injustices rousing empathetic conscientization at large magnanimously beyond finite boundaries fencing our confining perimetrical territorial exclusivities entrenched regrettably
[2024-05-31 03:28:09,202][__main__][INFO] - Watermarked Text: Symbolism holds immense significance in To Kill a Mockingbird as a literary technique interlaced skillfully by writer Harper Lee throughout the narrative, which deep-rooted essential aspects that allow thorough understandings concerning racial prejudices, judicial bias and moral development present within Maycomb county society during the early 1930s. The mockingbird serves as an embodiment symbolizing innocent victims whose lives or societal standers take unwarranted negative drifts due to inherent evil forces target innocent souls devoid of intentional wrongdoings in this intricate Southern backdrop steeped rich in historical segregation woes explicated poignantly. Another example is when Jem loses faith and hope following Tom Robinson's tragic demise while Boo Radley transformively alters her misconceptions through his hidden humanity underneath an underrated characterization shrouded ominously for reasons never truly clarified conclusively but interpreted alternatively differently with the reader perceptions and ability readdress predisposed conclusions surrounding unfamiliar people they once harshly judged before having meaningful connections thereby promoting tolerance ultimately towards marginalized underprivileged individuals needing their unbiased support unequivocally endlessly despite inevitable external criticism pressurised relentlessly negate one's virtuous efforts tirelessly battling against systemic injustices rousing empathetic conscientization at large magnanimously beyond finite boundaries fencing our confining perimetrical territorial exclusivities entrenched regrettably
[2024-05-31 03:28:09,203][__main__][INFO] - Is Watermark Detected?: True
[2024-05-31 03:28:09,203][__main__][INFO] - Score: 8.76943057566221
[2024-05-31 03:28:09,203][__main__][INFO] - Time taken: 464.17523407936096
Error executing job with overrides: ['++prompt_file=./inputs/tests_v1_with_lotr.csv', '++prompt_num=5', '++is_completion=False', '++generator_args.temperature=1.7', '++generator_args.diversity_penalty=15', '++generation_stats_file_path=./inputs/prompt_based_saves/prompt_5_temp_170_divp_15_attempt_3/stats.csv', '++watermarked_text_file_name=prompt_based_saves/prompt_5_temp_170_divp_15_attempt_3/watermarked_text.csv']
Traceback (most recent call last):
  File "/local1/borito1907/impossibility-watermark/watermarked_text_generator.py", line 41, in test
    save_to_csv(stats, './inputs', cfg.watermarked_text_file_name)
  File "/local1/borito1907/impossibility-watermark/utils.py", line 23, in save_to_csv
    df_out.to_csv(file_path, index=False)  # Create new file with headers
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/pandas/core/generic.py", line 3466, in to_csv
    return DataFrameRenderer(formatter).to_csv(
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/pandas/io/formats/format.py", line 1105, in to_csv
    csv_formatter.save()
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/pandas/io/formats/csvs.py", line 237, in save
    with get_handle(
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/pandas/io/common.py", line 702, in get_handle
    handle = open(
IsADirectoryError: [Errno 21] Is a directory: './inputs'

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
