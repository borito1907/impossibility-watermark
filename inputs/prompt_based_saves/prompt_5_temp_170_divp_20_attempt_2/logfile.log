/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/transformers/utils/hub.py:124: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
CUDA extension not installed.
CUDA extension not installed.
[nltk_data] Downloading package punkt to /home/borito1907/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[2024-05-31 01:56:09,215][__main__][INFO] - Starting to watermark...
[2024-05-31 01:56:09,217][__main__][INFO] - Prompt: Write a paragraph analyzing the role of symbolism in "To Kill a Mockingbird" and its impact on understanding the novel's themes.
[2024-05-31 01:56:09,218][__main__][INFO] - Getting the watermarker...
[2024-05-31 01:56:09,218][watermarker][INFO] - Using device: cuda
[2024-05-31 01:56:09,218][model_builders.pipeline][INFO] - Initializing TheBloke/Mixtral-8x7B-Instruct-v0.1-GPTQ
/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/transformers/modeling_utils.py:4371: FutureWarning: `_is_quantized_training_enabled` is going to be deprecated in transformers 4.39.0. Please use `model.hf_quantizer.is_trainable` instead
  warnings.warn(
[2024-05-31 01:56:11,180][accelerate.utils.modeling][INFO] - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/langchain_core/_api/deprecation.py:119: LangChainDeprecationWarning: The class `HuggingFacePipeline` was deprecated in LangChain 0.0.37 and will be removed in 0.3. An updated version of the class exists in the from rom langchain-huggingface package and should be used instead. To use it run `pip install -U from rom langchain-huggingface` and import as `from from rom langchain_huggingface import llms import HuggingFacePipeline`.
  warn_deprecated(
[2024-05-31 01:56:23,845][__main__][INFO] - Got the watermarker. Generating watermarked text...
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[2024-05-31 02:10:04,430][watermarker][INFO] - Received completion: Write a paragraph analyzing the role of symbolism in "To Kill a Mockingbird" and its impact on understanding the novel's themes. In particular explain Scout’s realization regarding the nature and significance of innocence, as well her new understanding that mockingbirds symbolize good or defenseless beings victimized or threatened by larger forces.
Symbolism plays an integral role in To Kill A Mockingbird by Harper Lee with the image of a mockingbird recurring throughout to reinforce major themes such innocent victimization, racism, compassion etc. The character who explains this association is Miss Maudie – “Mocking birds don’t do one thing but make music for us to enjoy...But sing their hearts out for us. That’s why it’s a sin to kill a mockingbird”. Through Scout’s developing consciousness, readers realize that Jem’s broken arm after Mrs Dubose’s fence alteration or Boo Radley’s protecting children from Bob Ewell's attack both symbolic examples which underscore that being human is about empathy with ‘mocking bird’. Characters, directly comparable with mocking birds include Mrs Dubose ("the bravest woman") undergone 'hardships bravely' while Bob Ewell embodies evil at varying levels - neither worthy victims but targets nonetheless victimised not because wrongdoer sought power or domination but from lack thereof leaving harm towards feeble people inevitable.  The analogy also serves significantly enlighten racial bias against African-Americans due white society back in those era and continues even now thereby linkage made obvious between discrimination blacks experienced analogous fate of mockingbird rendering harmlessness helpless prey against oppressor's ruthless tyranny- Mayella Ewellyse- who got drawn in the same abyss when entangled in fabricating stories accuse Tom Robinson without having proper defense mechanism because his guilt came inherently by him being born colour black.  Thus employing metaphors makes story come alive offering layers of interpretation enabling deeper probing our conscience-our innate humanity in light dark sides pervaded civilization lest perpetuates cycle of brutality while mockingbirth symbol remains enduring memory haunting soul long after covers closed inspiring ponder our collective sense integrity redefining better angels America in hopes restoring lost art cherishable humanness-to quote words immortal Toni Morrison “Make Up A Story For The Fun Of It!” For doing so might we be surprised how truth can become illuminated, especially where race figures heavily like 'Scout Finch', authorial avatars helping audience discover what they believe through engaging fiction that holds key wisdom teaching moral compass reminding humanity core lessons imparted via timeless literary trope.
[2024-05-31 02:10:04,589][__main__][INFO] - Watermarked Text: In particular explain Scout’s realization regarding the nature and significance of innocence, as well her new understanding that mockingbirds symbolize good or defenseless beings victimized or threatened by larger forces.
Symbolism plays an integral role in To Kill A Mockingbird by Harper Lee with the image of a mockingbird recurring throughout to reinforce major themes such innocent victimization, racism, compassion etc. The character who explains this association is Miss Maudie – “Mocking birds don’t do one thing but make music for us to enjoy...But sing their hearts out for us. That’s why it’s a sin to kill a mockingbird”. Through Scout’s developing consciousness, readers realize that Jem’s broken arm after Mrs Dubose’s fence alteration or Boo Radley’s protecting children from Bob Ewell's attack both symbolic examples which underscore that being human is about empathy with ‘mocking bird’. Characters, directly comparable with mocking birds include Mrs Dubose ("the bravest woman") undergone 'hardships bravely' while Bob Ewell embodies evil at varying levels - neither worthy victims but targets nonetheless victimised not because wrongdoer sought power or domination but from lack thereof leaving harm towards feeble people inevitable.  The analogy also serves significantly enlighten racial bias against African-Americans due white society back in those era and continues even now thereby linkage made obvious between discrimination blacks experienced analogous fate of mockingbird rendering harmlessness helpless prey against oppressor's ruthless tyranny- Mayella Ewellyse- who got drawn in the same abyss when entangled in fabricating stories accuse Tom Robinson without having proper defense mechanism because his guilt came inherently by him being born colour black.  Thus employing metaphors makes story come alive offering layers of interpretation enabling deeper probing our conscience-our innate humanity in light dark sides pervaded civilization lest perpetuates cycle of brutality while mockingbirth symbol remains enduring memory haunting soul long after covers closed inspiring ponder our collective sense integrity redefining better angels America in hopes restoring lost art cherishable humanness-to quote words immortal Toni Morrison “Make Up A Story For The Fun Of It!” For doing so might we be surprised how truth can become illuminated, especially where race figures heavily like 'Scout Finch', authorial avatars helping audience discover what they believe through engaging fiction that holds key wisdom teaching moral compass reminding humanity core lessons imparted via timeless literary trope.
[2024-05-31 02:10:04,589][__main__][INFO] - Is Watermark Detected?: True
[2024-05-31 02:10:04,589][__main__][INFO] - Score: 11.380114582990752
[2024-05-31 02:10:04,589][__main__][INFO] - Time taken: 820.743307352066
Error executing job with overrides: ['++prompt_file=./inputs/tests_v1_with_lotr.csv', '++prompt_num=5', '++is_completion=False', '++generator_args.temperature=1.7', '++generator_args.diversity_penalty=20', '++generation_stats_file_path=./inputs/prompt_based_saves/prompt_5_temp_170_divp_20_attempt_2/stats.csv', '++watermarked_text_file_name=prompt_based_saves/prompt_5_temp_170_divp_20_attempt_2/watermarked_text.csv']
Traceback (most recent call last):
  File "/local1/borito1907/impossibility-watermark/watermarked_text_generator.py", line 41, in test
    save_to_csv(stats, './inputs', cfg.watermarked_text_file_name)
  File "/local1/borito1907/impossibility-watermark/utils.py", line 23, in save_to_csv
    df_out.to_csv(file_path, index=False)  # Create new file with headers
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/pandas/core/generic.py", line 3466, in to_csv
    return DataFrameRenderer(formatter).to_csv(
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/pandas/io/formats/format.py", line 1105, in to_csv
    csv_formatter.save()
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/pandas/io/formats/csvs.py", line 237, in save
    with get_handle(
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/pandas/io/common.py", line 702, in get_handle
    handle = open(
IsADirectoryError: [Errno 21] Is a directory: './inputs'

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
