/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/transformers/utils/hub.py:124: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
CUDA extension not installed.
CUDA extension not installed.
[nltk_data] Downloading package punkt to /home/borito1907/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[2024-05-31 02:50:53,385][__main__][INFO] - Starting to watermark...
[2024-05-31 02:50:53,387][__main__][INFO] - Prompt: Write a paragraph analyzing the role of symbolism in "To Kill a Mockingbird" and its impact on understanding the novel's themes.
[2024-05-31 02:50:53,387][__main__][INFO] - Getting the watermarker...
[2024-05-31 02:50:53,387][watermarker][INFO] - Using device: cuda
[2024-05-31 02:50:53,387][model_builders.pipeline][INFO] - Initializing TheBloke/Mixtral-8x7B-Instruct-v0.1-GPTQ
/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/transformers/modeling_utils.py:4371: FutureWarning: `_is_quantized_training_enabled` is going to be deprecated in transformers 4.39.0. Please use `model.hf_quantizer.is_trainable` instead
  warnings.warn(
[2024-05-31 02:50:55,362][accelerate.utils.modeling][INFO] - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/langchain_core/_api/deprecation.py:119: LangChainDeprecationWarning: The class `HuggingFacePipeline` was deprecated in LangChain 0.0.37 and will be removed in 0.3. An updated version of the class exists in the from rom langchain-huggingface package and should be used instead. To use it run `pip install -U from rom langchain-huggingface` and import as `from from rom langchain_huggingface import llms import HuggingFacePipeline`.
  warn_deprecated(
[2024-05-31 02:51:08,251][__main__][INFO] - Got the watermarker. Generating watermarked text...
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[2024-05-31 03:00:03,643][watermarker][INFO] - Received completion: Write a paragraph analyzing the role of symbolism in "To Kill a Mockingbird" and its impact on understanding the novel's themes.
Symbolism plays a significant role in Harper Lee's "To Kill a Mockingbird," adding depth to her exploration of racial prejudice, morality, and innocence. For example, mockingbirds represent innocent beings that are victims of unfortunate circumstances beyond their control. This ties into several characters such as Boo Radley and Tom Robinson, who face hostility due to societal pressures related to racism and ignorance. By associating these individuals with mockingbirds, Lee underscores their purity even when they become targets for malicious actions by those less worthy.
Additionally, houses function as symbols representing varying levels of comfort and acceptance within Maycomb County. Scout and Jem's home embodies warmth, security, learning, and respect - reflective of Atticus Finch's principles. In contrast, Boo Radley's house symbolizes fear, misunderstanding, and exclusion from society, while Mrs. Dubose's residence exudes sternness but gradually transforms into a symbol of courage after her demise. These disparate symbols highlight both hopefulness found among some families versus others consumed by hate.
Furthermore, Lee effectively uses weather patterns symbolically: A major storm during the trial sequence parallels the turmoil unfolding with Robinson, amplifying the emotional impact on readers regarding his unjust treatment. Conversely, snow falling during another scene illustrates peace, tranquility, but also serves as an agent cleansing the town of previous sins. These subtle yet powerful uses of symbolism strengthen readers' connection to "To Kill a Mockingbird's" prominent themes, compelling us to confront harsh realities, embrace diversity, uphold justice despite adversity.
[2024-05-31 03:00:03,744][__main__][INFO] - Watermarked Text: Symbolism plays a significant role in Harper Lee's "To Kill a Mockingbird," adding depth to her exploration of racial prejudice, morality, and innocence. For example, mockingbirds represent innocent beings that are victims of unfortunate circumstances beyond their control. This ties into several characters such as Boo Radley and Tom Robinson, who face hostility due to societal pressures related to racism and ignorance. By associating these individuals with mockingbirds, Lee underscores their purity even when they become targets for malicious actions by those less worthy.
Additionally, houses function as symbols representing varying levels of comfort and acceptance within Maycomb County. Scout and Jem's home embodies warmth, security, learning, and respect - reflective of Atticus Finch's principles. In contrast, Boo Radley's house symbolizes fear, misunderstanding, and exclusion from society, while Mrs. Dubose's residence exudes sternness but gradually transforms into a symbol of courage after her demise. These disparate symbols highlight both hopefulness found among some families versus others consumed by hate.
Furthermore, Lee effectively uses weather patterns symbolically: A major storm during the trial sequence parallels the turmoil unfolding with Robinson, amplifying the emotional impact on readers regarding his unjust treatment. Conversely, snow falling during another scene illustrates peace, tranquility, but also serves as an agent cleansing the town of previous sins. These subtle yet powerful uses of symbolism strengthen readers' connection to "To Kill a Mockingbird's" prominent themes, compelling us to confront harsh realities, embrace diversity, uphold justice despite adversity.
[2024-05-31 03:00:03,744][__main__][INFO] - Is Watermark Detected?: True
[2024-05-31 03:00:03,744][__main__][INFO] - Score: 5.986969978529166
[2024-05-31 03:00:03,744][__main__][INFO] - Time taken: 535.4933915138245
Error executing job with overrides: ['++prompt_file=./inputs/tests_v1_with_lotr.csv', '++prompt_num=5', '++is_completion=False', '++generator_args.temperature=1.3', '++generator_args.diversity_penalty=20', '++generation_stats_file_path=./inputs/prompt_based_saves/prompt_5_temp_130_divp_20_attempt_3/stats.csv', '++watermarked_text_file_name=prompt_based_saves/prompt_5_temp_130_divp_20_attempt_3/watermarked_text.csv']
Traceback (most recent call last):
  File "/local1/borito1907/impossibility-watermark/watermarked_text_generator.py", line 41, in test
    save_to_csv(stats, './inputs', cfg.watermarked_text_file_name)
  File "/local1/borito1907/impossibility-watermark/utils.py", line 23, in save_to_csv
    df_out.to_csv(file_path, index=False)  # Create new file with headers
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/pandas/core/generic.py", line 3466, in to_csv
    return DataFrameRenderer(formatter).to_csv(
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/pandas/io/formats/format.py", line 1105, in to_csv
    csv_formatter.save()
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/pandas/io/formats/csvs.py", line 237, in save
    with get_handle(
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.10/site-packages/pandas/io/common.py", line 702, in get_handle
    handle = open(
IsADirectoryError: [Errno 21] Is a directory: './inputs'

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
