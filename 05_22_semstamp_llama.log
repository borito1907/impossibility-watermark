/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/transformers/utils/hub.py:122: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
[nltk_data] Downloading package punkt to /home/borito1907/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[2024-05-22 13:20:07,047][__main__][INFO] - Starting to watermark...
[2024-05-22 13:20:07,047][__main__][INFO] - Prompt: Write a 250 word essay on the role of power and its impact on characters in the Lord of the Rings 
        series. How does the ring symbolize power, and what does Tolkien suggest about the nature of power?

        Answer:
[2024-05-22 13:20:07,047][__main__][INFO] - Getting the watermarker...
[2024-05-22 13:20:07,047][watermarker][INFO] - Using device: cuda
[2024-05-22 13:20:07,047][root][INFO] - Device: auto
[2024-05-22 13:20:07,047][model_builders.pipeline][INFO] - Initializing MaziyarPanahi/Meta-Llama-3-70B-Instruct-GPTQ
/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
INFO - You passed a model that is compatible with the Marlin int4*fp16 GPTQ kernel but use_marlin is False. We recommend using `use_marlin=True` to use the optimized Marlin kernels for inference. Example: `model = AutoGPTQForCausalLM.from_quantized(..., use_marlin=True)`.
INFO - The layer lm_head is not quantized.
[2024-05-22 13:20:10,834][accelerate.utils.modeling][INFO] - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
The model 'LlamaGPTQForCausalLM' is not supported for text-generation. Supported models are ['BartForCausalLM', 'BertLMHeadModel', 'BertGenerationDecoder', 'BigBirdForCausalLM', 'BigBirdPegasusForCausalLM', 'BioGptForCausalLM', 'BlenderbotForCausalLM', 'BlenderbotSmallForCausalLM', 'BloomForCausalLM', 'CamembertForCausalLM', 'LlamaForCausalLM', 'CodeGenForCausalLM', 'CpmAntForCausalLM', 'CTRLLMHeadModel', 'Data2VecTextForCausalLM', 'ElectraForCausalLM', 'ErnieForCausalLM', 'FalconForCausalLM', 'FuyuForCausalLM', 'GitForCausalLM', 'GPT2LMHeadModel', 'GPT2LMHeadModel', 'GPTBigCodeForCausalLM', 'GPTNeoForCausalLM', 'GPTNeoXForCausalLM', 'GPTNeoXJapaneseForCausalLM', 'GPTJForCausalLM', 'LlamaForCausalLM', 'MarianForCausalLM', 'MBartForCausalLM', 'MegaForCausalLM', 'MegatronBertForCausalLM', 'MistralForCausalLM', 'MixtralForCausalLM', 'MptForCausalLM', 'MusicgenForCausalLM', 'MvpForCausalLM', 'OpenLlamaForCausalLM', 'OpenAIGPTLMHeadModel', 'OPTForCausalLM', 'PegasusForCausalLM', 'PersimmonForCausalLM', 'PhiForCausalLM', 'PLBartForCausalLM', 'ProphetNetForCausalLM', 'QDQBertLMHeadModel', 'ReformerModelWithLMHead', 'RemBertForCausalLM', 'RobertaForCausalLM', 'RobertaPreLayerNormForCausalLM', 'RoCBertForCausalLM', 'RoFormerForCausalLM', 'RwkvForCausalLM', 'Speech2Text2ForCausalLM', 'TransfoXLLMHeadModel', 'TrOCRForCausalLM', 'WhisperForCausalLM', 'XGLMForCausalLM', 'XLMWithLMHeadModel', 'XLMProphetNetForCausalLM', 'XLMRobertaForCausalLM', 'XLMRobertaXLForCausalLM', 'XLNetLMHeadModel', 'XmodForCausalLM'].
[2024-05-22 13:20:21,792][semstamp][INFO] - {'max_new_tokens': 1024, 'do_sample': True, 'temperature': 0.7, 'top_p': 0.95, 'top_k': 40, 'repetition_penalty': 1.1, 'bad_words_ids': [[198]], 'min_new_tokens': 195}
[2024-05-22 13:20:21,792][semstamp][INFO] - Initializing embedder model.
[2024-05-22 13:20:21,792][sentence_transformers.SentenceTransformer][INFO] - Load pretrained SentenceTransformer: sentence-transformers/all-mpnet-base-v1
/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
[2024-05-22 13:20:22,989][sentence_transformers.SentenceTransformer][INFO] - Use pytorch device_name: cuda
[2024-05-22 13:20:23,055][semstamp][INFO] - Finished initializing embedder model.
initializing random projection LSH model
loading SBERT base model...
[2024-05-22 13:20:23,060][__main__][INFO] - Got the watermarker. Generating watermarked text...
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00,  2.26it/s]Batches: 100%|██████████| 1/1 [00:00<00:00,  2.26it/s]
[2024-05-22 13:20:23,529][model_builders.pipeline][INFO] - Prompt: Write a 250 word essay on the role of power and its impact on characters in the Lord of the Rings 
        series.
/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/langchain_core/_api/deprecation.py:119: LangChainDeprecationWarning: The method `BaseLLM.__call__` was deprecated in langchain-core 0.1.7 and will be removed in 0.2.0. Use invoke instead.
  warn_deprecated(
Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
[2024-05-22 13:20:44,733][SemStamp.sampling_lsh_utils][INFO] - Candidate text: In J.R.R. Tolkien's epic Lord of the Rings series, power plays a pivotal role in shaping the destinies of its characters. The struggle for power is a recurring theme throughout the narrative, (the One Ring) as it corrupts even the noblest of intentions.

The primary example of power's corrosive influence is Boromir,son of Denethor, Steward of Gondor. Initially, driven by a desire to protect his city from the forces of darkness, Boromir becomes increasingly consumed by the Ring's promise of power. His obsessive quest to possess the Ring ultimately leads to his downfall and tragic demise. This transformation highlights how even the most well-intentioned individuals can fall prey to power's insidious allure.

On the other hand, characters like Gandalf and Samwise Gamgee demonstrate that power can also be wielded responsibly. Gandalf, the wise wizard resists the temptation of the Ring's power recognizing its inherent danger. Similarly Samwise Gamgee humble hobbit servant and loyal companion to Frodo exhibits remarkable selflessness and humility refusing to succumb to the Ring's seductive influence.

Tolkien masterfully illustrates that the pursuit of power without accountability or moral guidance can lead to catastrophic consequences. Conversely he shows that responsible stewardship of power can bring about salvation and redemption. Through the complexities of power's impact on his characters Tolkien cautions readers against the dangers of unchecked ambition and encourages them to strive for wisdom compassion and integrity in their own pursuit of power and authority.
[2024-05-22 13:20:44,734][SemStamp.sampling_lsh_utils][INFO] - Accept Mask: tensor([1, 4], device='cuda:0')
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 81.57it/s]
[2024-05-22 13:20:44,753][model_builders.pipeline][INFO] - Prompt: Write a 250 word essay on the role of power and its impact on characters in the Lord of the Rings 
        series.
Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
[2024-05-22 13:21:10,262][SemStamp.sampling_lsh_utils][INFO] - Candidate text: In J.R.R. Tolkien's esteemed Lord of the Rings series, the concept of power plays a pivotal role in shaping the characters and their destinies. The struggle for power is a recurring theme throughout the narrative, influencing the actions and motivations of various characters.

On one hand, the corrupting influence of power is exemplified through the character of Gollum. Once a hobbit named Sméagol, he was consumed by the power of the One Ring, leading to his downfall and eventual demise. The Ring's power twisted his mind and soul, driving him to commit unspeakable acts, including murder and betrayal. This serves as a cautionary tale about the dangers of unchecked power and the devastating consequences it can have on individuals.

On the other hand, the wise and powerful wizard Gandalf demonstrates the responsible use of power. As a guardian of Middle-earth, he wields significant authority yet remains humble and selfless. His power is not driven by personal ambition but rather by a desire to protect and serve others. This dichotomy between Gollum and Gandalf highlights the importance of accountability and moral guidance when possessing power.

Furthermore, the character of Boromir, son of Denethor, showcases the temptation of power and its potential to cloud judgment. His desire to possess the One Ring and utilize its power to save Gondor ultimately leads to his downfall and tragic demise. This serves as a reminder that even those with noble intentions can be swayed by the lure of power, emphasizing the need for vigilance and self-awareness.

Through these characters, Tolkien masterfully illustrates the double-edged nature of power, demonstrating both its capacity to destroy and uplift. Ultimately, the Lord of the Rings series teaches us that true strength lies not in the possession of power, but in the wisdom and courage to wield it responsibly.
[2024-05-22 13:21:10,262][SemStamp.sampling_lsh_utils][INFO] - Accept Mask: tensor([1, 4], device='cuda:0')
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 67.20it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 93.70it/s]
[2024-05-22 13:21:10,293][SemStamp.sampling_lsh_utils][INFO] - LSH Candidate: 4
[2024-05-22 13:21:10,294][SemStamp.sampling_lsh_utils][INFO] - Candidate text falls within the semantic partition.
[2024-05-22 13:21:10,295][model_builders.pipeline][INFO] - Prompt: Write a 250 word essay on the role of power and its impact on characters in the Lord of the Rings 
        series.In J.R.R. Tolkien's esteemed Lord of the Rings series, the concept of power plays a pivotal role in shaping the characters and their destinies. The struggle for power is a recurring theme throughout the narrative, influencing the actions and motivations of various characters.

On one hand, the corrupting influence of power is exemplified through the character of Gollum. Once a hobbit named Sméagol, he was consumed by the power of the One Ring, leading to his downfall and eventual demise. The Ring's power twisted his mind and soul, driving him to commit unspeakable acts, including murder and betrayal. This serves as a cautionary tale about the dangers of unchecked power and the devastating consequences it can have on individuals.

On the other hand, the wise and powerful wizard Gandalf demonstrates the responsible use of power. As a guardian of Middle-earth, he wields significant authority yet remains humble and selfless. His power is not driven by personal ambition but rather by a desire to protect and serve others. This dichotomy between Gollum and Gandalf highlights the importance of accountability and moral guidance when possessing power.

Furthermore, the character of Boromir, son of Denethor, showcases the temptation of power and its potential to cloud judgment. His desire to possess the One Ring and utilize its power to save Gondor ultimately leads to his downfall and tragic demise. This serves as a reminder that even those with noble intentions can be swayed by the lure of power, emphasizing the need for vigilance and self-awareness.

Through these characters, Tolkien masterfully illustrates the double-edged nature of power, demonstrating both its capacity to destroy and uplift. Ultimately, the Lord of the Rings series teaches us that true strength lies not in the possession of power, but in the wisdom and courage to wield it responsibly.
Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
[2024-05-22 13:21:40,014][SemStamp.sampling_lsh_utils][INFO] - Candidate text: Your essay provides a thoughtful analysis of the role of power in J.R.R. Tolkien's Lord of the Rings series. Here's a polished version:

In J.R.R. Tolkien's revered Lord of the Rings series, the concept of power plays a pivotal role in shaping the characters and their destinies. The struggle for power is a recurring theme throughout the narrative, to influence the actions and motivations of various characters.

On one hand, the corrupting influence of power is exemplified through the character of Gollum. Once a hobbit named Sméagol, he was consumed by the power of the One Ring, leading to his downfall and eventual demise. The Ring's power twisted his mind and soul, driving him to commit unspeakable acts, including murder and betrayal. This serves as a cautionary tale about the dangers of unchecked power and the devastating consequences it can have on individuals.

On the other hand, the wise and powerful wizard Gandalf demonstrates the responsible use of power. As a guardian of Middle-earth, he wields significant authority yet remains humble and selfless. His power is not driven by personal ambition but rather by a desire to protect and serve others. This dichotomy between Gollum and Gandalf highlights the importance of accountability and moral guidance when possessing power.

The character of Boromir, son of Denethor, further showcases the temptation of power and its potential to cloud judgment. His desire to possess the One Ring and utilize its power to save Gondor ultimately leads to his downfall and tragic demise. This serves as a reminder that even those with noble intentions can be swayed by the lure of power, emphasizing the need for vigilance and self-awareness.

Through these characters, Tolkien masterfully illustrates the double-edged nature of power, demonstrating both its capacity to destroy and uplift. Ultimately, the Lord of the Rings series teaches us that true strength lies not in the possession of power, but in the wisdom and courage to wield it responsibly.
[2024-05-22 13:21:40,014][SemStamp.sampling_lsh_utils][INFO] - Accept Mask: tensor([7, 2], device='cuda:0')
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 72.57it/s]
[2024-05-22 13:21:40,032][model_builders.pipeline][INFO] - Prompt: Write a 250 word essay on the role of power and its impact on characters in the Lord of the Rings 
        series.In J.R.R. Tolkien's esteemed Lord of the Rings series, the concept of power plays a pivotal role in shaping the characters and their destinies. The struggle for power is a recurring theme throughout the narrative, influencing the actions and motivations of various characters.

On one hand, the corrupting influence of power is exemplified through the character of Gollum. Once a hobbit named Sméagol, he was consumed by the power of the One Ring, leading to his downfall and eventual demise. The Ring's power twisted his mind and soul, driving him to commit unspeakable acts, including murder and betrayal. This serves as a cautionary tale about the dangers of unchecked power and the devastating consequences it can have on individuals.

On the other hand, the wise and powerful wizard Gandalf demonstrates the responsible use of power. As a guardian of Middle-earth, he wields significant authority yet remains humble and selfless. His power is not driven by personal ambition but rather by a desire to protect and serve others. This dichotomy between Gollum and Gandalf highlights the importance of accountability and moral guidance when possessing power.

Furthermore, the character of Boromir, son of Denethor, showcases the temptation of power and its potential to cloud judgment. His desire to possess the One Ring and utilize its power to save Gondor ultimately leads to his downfall and tragic demise. This serves as a reminder that even those with noble intentions can be swayed by the lure of power, emphasizing the need for vigilance and self-awareness.

Through these characters, Tolkien masterfully illustrates the double-edged nature of power, demonstrating both its capacity to destroy and uplift. Ultimately, the Lord of the Rings series teaches us that true strength lies not in the possession of power, but in the wisdom and courage to wield it responsibly.
Setting `pad_token_id` to `eos_token_id`:128001 for open-end generation.
Traceback (most recent call last):
  File "/local1/borito1907/impossibility-watermark/watermarker_tester.py", line 39, in <module>
    test()
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
           ^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
            ^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
          ^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/impossibility-watermark/watermarker_tester.py", line 29, in test
    watermarked_text = watermarker.generate(prompt)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/impossibility-watermark/watermarker.py", line 50, in generate
    completion = self.generate_watermarked_outputs(prompt)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/impossibility-watermark/semstamp.py", line 77, in generate_watermarked_outputs
    return self._lsh_generate_watermarked_outputs(prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/impossibility-watermark/semstamp.py", line 87, in _lsh_generate_watermarked_outputs
    response = lsh_reject_completion(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/impossibility-watermark/SemStamp/sampling_lsh_utils.py", line 125, in lsh_reject_completion
    generated_text = pipeline.generate_text(text, generator_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/impossibility-watermark/model_builders/pipeline.py", line 164, in generate_text
    output = self.pipeline(generated_prompt, **generator_kwargs) 
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/langchain_core/_api/deprecation.py", line 148, in warning_emitting_wrapper
    return wrapped(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/langchain_core/language_models/llms.py", line 1086, in __call__
    self.generate(
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/langchain_core/language_models/llms.py", line 803, in generate
    output = self._generate_helper(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/langchain_core/language_models/llms.py", line 670, in _generate_helper
    raise e
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/langchain_core/language_models/llms.py", line 657, in _generate_helper
    self._generate(
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/langchain_community/llms/huggingface_pipeline.py", line 267, in _generate
    responses = self.pipeline(
                ^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/transformers/pipelines/text_generation.py", line 208, in __call__
    return super().__call__(text_inputs, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/transformers/pipelines/base.py", line 1121, in __call__
    outputs = list(final_iterator)
              ^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/transformers/pipelines/pt_utils.py", line 124, in __next__
    item = next(self.iterator)
           ^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/transformers/pipelines/pt_utils.py", line 125, in __next__
    processed = self.infer(item, **self.params)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/transformers/pipelines/base.py", line 1046, in forward
    model_outputs = self._forward(model_inputs, **forward_params)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/transformers/pipelines/text_generation.py", line 271, in _forward
    generated_sequence = self.model.generate(input_ids=input_ids, attention_mask=attention_mask, **generate_kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/AutoGPTQ/auto_gptq/modeling/_base.py", line 433, in generate
    return self.model.generate(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/transformers/generation/utils.py", line 1777, in generate
    return self.sample(
           ^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/transformers/generation/utils.py", line 2874, in sample
    outputs = self(
              ^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/transformers/models/llama/modeling_llama.py", line 1183, in forward
    outputs = self.model(
              ^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/transformers/models/llama/modeling_llama.py", line 1070, in forward
    layer_outputs = decoder_layer(
                    ^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/transformers/models/llama/modeling_llama.py", line 798, in forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
                                                          ^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/transformers/models/llama/modeling_llama.py", line 706, in forward
    query_states, key_states = apply_rotary_pos_emb(query_states, key_states, cos, sin, position_ids)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/transformers/models/llama/modeling_llama.py", line 234, in apply_rotary_pos_emb
    q_embed = (q * cos) + (rotate_half(q) * sin)
                           ^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/transformers/models/llama/modeling_llama.py", line 204, in rotate_half
    def rotate_half(x):
    
KeyboardInterrupt
