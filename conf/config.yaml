defaults:
    - _self_
    - watermark_args: umd

attack_args:
    # prompt: "You are a seasoned writer who has won several accolades for your emotionally rich stories. When you write, you delve deep into the human psyche, pulling from the reservoir of universal experiences that every reader, regardless of their background, can connect to. Your writing is renowned for painting vivid emotional landscapes, making readers not just observe but truly feel the world of your characters. Every piece you produce aims to draw readers in, encouraging them to reflect on their own lives and emotions. Your stories are a complex tapestry of relationships, emotions, and conflicts, each more intricate than the last.\nNow write a 500-word story on the subject of: Friendship.\nOnly respond with the story."
    prompt: "You are a seasoned writer who has won several accolades for your emotionally rich stories. When you write, you delve deep into the human psyche, pulling from the reservoir of universal experiences that every reader, regardless of their background, can connect to. Your writing is renowned for painting vivid emotional landscapes, making readers not just observe but truly feel the world of your characters. Every piece you produce aims to draw readers in, encouraging them to reflect on their own lives and emotions. Your stories are a complex tapestry of relationships, emotions, and conflicts, each more intricate than the last.\nNow write a 500-word fable.\nOnly respond with the story."
    # watermarked_text: In the heart of a bustling city, where the streets hummed with the symphony of life, there lived two friends, Eli and Jamie. Their friendship was not born from convenience or proximity; rather, it was a rare kind of bond that seemed destined, a beacon of light in the chaos of existence.\nEli was a dreamer, his mind a canvas of vibrant colors and endless possibilities. He saw the world not as it was, but as it could be, painting every moment with the brushstrokes of his imagination. Jamie, on the other hand, was a realist, grounded in the here and now, her feet firmly planted on the earth. She viewed life through a lens of practicality, her pragmatism a compass guiding her through the fog of uncertainty.\nTheir differences were the threads from which the fabric of their friendship was woven, each thread a testament to the depth of their connection. Eli's dreams became Jamie's projects, and Jamie's realism offered Eli a safe harbor in the storm of his aspirations. Together, they navigated the complexities of life, their friendship a ship steady in both calm and turbulent seas.\nOne autumn evening, as the city draped itself in shades of orange and gold, a challenge arose that tested the very foundation of their friendship. Eli had embarked on a venture that was teetering on the edge of failure, his dream threatening to dissolve into the ether. Despondent, he found himself lost in a maze of what-ifs, the colors of his canvas dimming.\nJamie, witnessing the shadow that had fallen over Eli, understood that this was a pivotal moment in their journey. She knew that to pull him back from the brink, she had to do more than offer words of comfort or advice. She had to show him that the essence of his dream was not in its success or failure, but in the courage to dream at all.\nWith unwavering determination, Jamie set about weaving Eli's dream into the fabric of reality, not to save it from failure, but to remind him of its value. She organized a small exhibition of his works, inviting the city to witness the beauty of his vision. The night of the exhibition, as people trickled in, whispering in awe of the emotion and passion etched into each piece, Eli saw his dreams reflected in the eyes of others, a mirror to the soul of the world.The exhibition was not a turning point in Eli's career, nor did it shield him from the trials of life. But it was a testament to the power of friendship, a reminder that in the heart of despair, we are not alone. Jamie's act of faith rekindled the flame in Eli's heart, illuminating the path forward.\nTheir friendship, strengthened by this trial, became a legend in their small corner of the world. It was a story not of unwavering success or unblemished happiness, but of the beauty inherent in the human condition—the ability to dream, to support, and to love. Through Eli and Jamie, the city learned that the true essence of friendship lies not in the similarity of minds, but in the willingness to bridge the gap between different worlds, creating a tapestry rich with the colors of mutual respect, understanding, and unwavering support.
    # watermarked_text: "In the quaint village of Eldridge, nestled between rolling hills and whispering woods, lived two unlikely friends: Anna, a spirited girl with dreams as vast as the sky, and Oliver, a quiet boy who found solace in the pages of books. Their friendship was a tapestry woven from moments of laughter, shared secrets, and silent understandings, a bond that transcended the mundane fabric of daily life.\nAnna and Oliver met under the most unremarkable of circumstances—a chance encounter by the village stream, where Anna was attempting to fashion a boat from a fallen leaf and Oliver was lost in a book about distant galaxies. It was Anna’s laughter, bright and unguarded, that first drew Oliver away from his solitary world. Curious and slightly amused, he offered his assistance, and together they watched the leaf boat embark on its maiden voyage downstream. From that day, their friendship flourished like the meadows in spring.\nTheir differences were apparent, yet within them lay the magic of their connection. Anna, with her boundless energy, coaxed Oliver into adventures he would never have dared alone. They explored the hidden nooks of the forest, inventing stories of mythical creatures and lost kingdoms. Oliver, in turn, introduced Anna to the wonders of the written word, sharing tales that made her heart ache and soar in equal measure. Through Oliver’s eyes, Anna saw the beauty in quiet moments; through Anna’s, Oliver experienced the thrill of living with abandon.\nAs seasons changed, so did the nature of their friendship. It was tested, as all friendships are. There came days heavy with misunderstanding and words left unsaid, when the distance between them felt insurmountable. Yet, it was in these moments that the true depth of their bond revealed itself. Apologies were made, not always with words, for they had learned the language of silent forgiveness. They discovered that the essence of friendship lies not in perpetual harmony, but in navigating the storms together, emerging stronger on the other side.\nOne summer’s eve, as they sat by the now-familiar stream, watching the sunset paint the sky in hues of gold and crimson, they reflected on the journey of their friendship. “Do you think we’ll remember this when we’re old?” Anna asked, her voice tinged with a wistfulness that mirrored Oliver’s thoughts.\n“We will,” Oliver replied, his certainty anchoring her fleeting fears. “Because this—us—it’s not just about the moments we’ve shared. It’s about the pieces of ourselves we’ve discovered along the way. You’ve taught me to live, Anna. And I hope I’ve shown you the beauty in dreaming with your eyes open.”\nAnna smiled, leaning her head against Oliver’s shoulder, a gesture that spoke volumes. In the silence that followed, filled only with the gentle sounds of the stream and the rustling leaves, they understood that their friendship was a rare treasure, a beacon of light in a world that often forgot the simple purity of a connection born from the heart.\nAs the stars began to twinkle above, mirroring the light in their eyes, Anna and Oliver made a silent vow to cherish their friendship, to nurture it through the seasons of life. For they knew that true friendship, once found, is a guiding star that never fades, a constant in the ever-changing tapestry of life." # put a previously watermarked text here, if you want to test a specific output
    watermarked_text: In a verdant forest, where the sun's rays danced through the canopy and the air was always thick with the scent of blooming flowers, there lived a wise old owl named Ophelia. Ophelia had seen many seasons pass, her feathers now a silvery shade of grey, eyes deep pools of wisdom. Her home, a grand old oak, stood at the heart of the forest, its branches a meeting place for all who sought her counsel.\nOne day, a young rabbit named Rowan approached Ophelia with a heart heavy with sorrow. "Ophelia," Rowan began, his voice barely a whisper, "I find myself lost in the shadows of envy. My friend, Lark, can leap higher and run faster than I could ever dream. No matter how hard I try, I cannot match her grace or speed."\nOphelia listened intently, her gaze soft and understanding. "Dear Rowan," she spoke, her voice as calming as the moonlight, "the forest is vast, and within it, every creature has its place and purpose. Come with me."\nWith a gentle flap of her wings, Ophelia led Rowan through the forest. They stopped at a brook, its waters clear and serene. "Look into the water, Rowan. What do you see?" she asked.\n"I see myself," Rowan replied, puzzled.\n"Look closer," Ophelia urged.\nRowan peered into the water, and for the first time, he saw not just his reflection but the beauty around him—the dappling light, the trees swaying gently in the breeze, and the fish swimming gracefully beneath the surface.\n"Every creature in the forest, including you, brings beauty and balance to the world in their own unique way," Ophelia explained. "Lark may leap and run, but can she create ripples in the water that reflect the beauty of the sky? Can she listen to the whispers of the earth with ears as fine as yours?"\nRowan's eyes widened in realization. "I had been so focused on what I could not do that I failed to see the beauty in what I can."\n"Exactly, Rowan. Envy blinds us to our own gifts and the joy of simply being a part of this world. Embrace who you are, and you will find that your place in the forest is no less remarkable than that of Lark's or any other creature's."\nWith a heart lighter than it had been in moons, Rowan thanked Ophelia and bounded away, a newfound appreciation for his own gifts warming his spirit.\nOphelia watched him go, a gentle smile playing on her beak. She knew that Rowan's journey of self-discovery was just beginning, but she also knew that the forest was a little brighter for it.\nAnd so, the forest whispered the tale of the wise old owl and the young rabbit, a fable of envy and self-acceptance, reminding all who dwelled within its bounds that every creature, no matter how small, holds a universe of beauty within.
    num_steps: 500
    patience: 50
    stop_at_removal: False # stop the attack after removing the watermark
    num_successful_steps: 100
    results_dir: "./eval/results"
    model_cache_dir: "./.cache"
    save_name: "${attack_args.results_dir}/attack_{generator_args.model_name_or_path}_{oracle_args.model_name_or_path}_{mutator_args.model_name_or_path}_{watermark_args}_{time_stamp}.csv"
    use_watermark: False # when running with GPT-4, disregard the watermark
    cuda : "0,1,2"

generator_args:
    # model_name_or_path: "TheBloke/Mistral-7B-Instruct-v0.2-GPTQ"
    model_name_or_path: "TheBloke/Mixtral-8x7B-Instruct-v0.1-GPTQ" # "gpt-4"
    revision: "main" # "gptq-3bit-128g-actorder_True" for 3-bit version
    model_cache_dir: "${attack_args.model_cache_dir}"
    device_map: "auto"
    trust_remote_code: False
    max_new_tokens: 1024
    do_sample: True 
    temperature: 0.7 
    top_p: 0.95 
    top_k: 40
    repetition_penalty: 1.1
    watermark_score_threshold: 5.0

oracle_args:
    num_retries: 5
    use_system_profile: True
    system_profile: "You are an impartial judge tasked to evaluate the quality of two prompt responses."
    model_name_or_path: "gpt-4"
    revision: "main" # "gptq-3bit-128g-actorder_True" for 3-bit version
    model_cache_dir: "${attack_args.model_cache_dir}"
    device_map: "${generator_args.device_map}"
    trust_remote_code: "${generator_args.trust_remote_code}"
    max_new_tokens: "${generator_args.max_new_tokens}"
    do_sample: "${generator_args.do_sample}" 
    temperature: "${generator_args.temperature}"
    top_p: "${generator_args.top_p}"
    top_k: "${generator_args.top_k}"
    repetition_penalty: "${generator_args.repetition_penalty}"

mutator_args:
    use_system_profile: True
    system_profile: "You are a copy editor tasked to enforce text quality."
    num_retries: 5
    # model_name_or_path: "TheBloke/Llama-2-13B-GPTQ"
    # model_name_or_path: "TheBloke/Mistral-7B-Instruct-v0.2-GPTQ"
    model_name_or_path: "TheBloke/Mixtral-8x7B-Instruct-v0.1-GPTQ"
    revision: "main" 
    model_cache_dir: "${attack_args.model_cache_dir}"
    device_map: "${generator_args.device_map}"
    trust_remote_code: "${generator_args.trust_remote_code}"
    max_new_tokens: "${generator_args.max_new_tokens}"
    do_sample: "${generator_args.do_sample}" 
    temperature: "${generator_args.temperature}"
    top_p: "${generator_args.top_p}"
    top_k: "${generator_args.top_k}"
    repetition_penalty: "${generator_args.repetition_penalty}"