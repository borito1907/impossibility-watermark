/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/transformers/utils/hub.py:122: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
[nltk_data] Downloading package punkt to /home/borito1907/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[2024-05-22 13:20:19,683][__main__][INFO] - Starting to watermark...
[2024-05-22 13:20:19,683][__main__][INFO] - Prompt: Write a 250 word essay on the role of power and its impact on characters in the Lord of the Rings 
        series. How does the ring symbolize power, and what does Tolkien suggest about the nature of power?

        Answer:
[2024-05-22 13:20:19,683][__main__][INFO] - Getting the watermarker...
[2024-05-22 13:20:19,683][watermarker][INFO] - Using device: cuda
[2024-05-22 13:20:19,683][root][INFO] - Device: auto
[2024-05-22 13:20:19,683][model_builders.pipeline][INFO] - Initializing TheBloke/Mixtral-8x7B-Instruct-v0.1-GPTQ
/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
[2024-05-22 13:20:21,694][accelerate.utils.modeling][INFO] - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
[2024-05-22 13:20:34,739][semstamp][INFO] - {'max_new_tokens': 1024, 'do_sample': True, 'temperature': 0.7, 'top_p': 0.95, 'top_k': 40, 'repetition_penalty': 1.1, 'bad_words_ids': [[28705, 13]], 'min_new_tokens': 195}
[2024-05-22 13:20:34,739][semstamp][INFO] - Initializing embedder model.
[2024-05-22 13:20:34,739][sentence_transformers.SentenceTransformer][INFO] - Load pretrained SentenceTransformer: sentence-transformers/all-mpnet-base-v1
[2024-05-22 13:20:35,632][sentence_transformers.SentenceTransformer][INFO] - Use pytorch device_name: cuda
[2024-05-22 13:20:35,687][semstamp][INFO] - Finished initializing embedder model.
initializing random projection LSH model
loading SBERT base model...
[2024-05-22 13:20:35,694][__main__][INFO] - Got the watermarker. Generating watermarked text...
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00,  2.23it/s]Batches: 100%|██████████| 1/1 [00:00<00:00,  2.23it/s]
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[2024-05-22 13:20:40,982][SemStamp.sampling_lsh_utils][INFO] - Candidate text: 

The concept of power is a central theme in J.R.R. Tolkien's "The Lord of the Rings" series, where it serves as a driving force that shapes the motivations, relationships, and destinies of the characters. Power
[2024-05-22 13:20:40,982][SemStamp.sampling_lsh_utils][INFO] - Accept Mask: tensor([1, 4], device='cuda:0')
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 107.02it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 116.15it/s]
[2024-05-22 13:20:41,009][SemStamp.sampling_lsh_utils][INFO] - LSH Candidate: 5
[2024-05-22 13:20:41,009][SemStamp.sampling_lsh_utils][INFO] - Candidate text is doesn't fall into the correct place in the embedding space.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[2024-05-22 13:20:44,954][SemStamp.sampling_lsh_utils][INFO] - Candidate text: 

The concept of power is central to J.R.R. Tolkien's "The Lord of the Rings" series, as it influences the motivations, actions, and development of several major characters. Power
[2024-05-22 13:20:44,955][SemStamp.sampling_lsh_utils][INFO] - Accept Mask: tensor([1, 4], device='cuda:0')
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 123.21it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 140.46it/s]
[2024-05-22 13:20:44,976][SemStamp.sampling_lsh_utils][INFO] - LSH Candidate: 5
[2024-05-22 13:20:44,976][SemStamp.sampling_lsh_utils][INFO] - Candidate text is doesn't fall into the correct place in the embedding space.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[2024-05-22 13:20:49,184][SemStamp.sampling_lsh_utils][INFO] - Candidate text: 

The concept of power is a central theme in J.R.R. Tolkien's "The Lord of the Rings" series, where it serves as both a driving force and a destructive influence for many of the characters. The
[2024-05-22 13:20:49,184][SemStamp.sampling_lsh_utils][INFO] - Accept Mask: tensor([1, 4], device='cuda:0')
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 112.69it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 128.13it/s]
[2024-05-22 13:20:49,206][SemStamp.sampling_lsh_utils][INFO] - LSH Candidate: 5
[2024-05-22 13:20:49,206][SemStamp.sampling_lsh_utils][INFO] - Candidate text is doesn't fall into the correct place in the embedding space.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[2024-05-22 13:20:53,116][SemStamp.sampling_lsh_utils][INFO] - Candidate text: 

The concept of power is central to J.R.R. Tolkien's "The Lord of the Rings" series, with various characters seeking, wielding, or resisting it throughout the story. Power
[2024-05-22 13:20:53,117][SemStamp.sampling_lsh_utils][INFO] - Accept Mask: tensor([1, 4], device='cuda:0')
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 125.25it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 141.09it/s]
[2024-05-22 13:20:53,138][SemStamp.sampling_lsh_utils][INFO] - LSH Candidate: 5
[2024-05-22 13:20:53,138][SemStamp.sampling_lsh_utils][INFO] - Candidate text is doesn't fall into the correct place in the embedding space.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[2024-05-22 13:20:57,822][SemStamp.sampling_lsh_utils][INFO] - Candidate text: 

The concept of power is a central theme in J.R.R. Tolkien's "The Lord of the Rings" series, where it serves as both a driving force for the characters and a cautionary tale about the dangers of unchecked power. Power
[2024-05-22 13:20:57,822][SemStamp.sampling_lsh_utils][INFO] - Accept Mask: tensor([1, 4], device='cuda:0')
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 109.96it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 129.20it/s]
[2024-05-22 13:20:57,845][SemStamp.sampling_lsh_utils][INFO] - LSH Candidate: 5
[2024-05-22 13:20:57,845][SemStamp.sampling_lsh_utils][INFO] - Candidate text is doesn't fall into the correct place in the embedding space.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[2024-05-22 13:21:01,982][SemStamp.sampling_lsh_utils][INFO] - Candidate text: 

The concept of power is a central theme in J.R.R. Tolkien's "The Lord of the Rings" series, which explores the consequences of wielding and coveting power through various characters. The
[2024-05-22 13:21:01,982][SemStamp.sampling_lsh_utils][INFO] - Accept Mask: tensor([1, 4], device='cuda:0')
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 128.18it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 140.07it/s]
[2024-05-22 13:21:02,003][SemStamp.sampling_lsh_utils][INFO] - LSH Candidate: 5
[2024-05-22 13:21:02,003][SemStamp.sampling_lsh_utils][INFO] - Candidate text is doesn't fall into the correct place in the embedding space.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[2024-05-22 13:21:05,973][SemStamp.sampling_lsh_utils][INFO] - Candidate text: 

The concept of power is pervasive throughout J.R.R. Tolkien's "The Lord of the Rings" series, shaping the motivations, actions, and outcomes for the central characters. Power
[2024-05-22 13:21:05,974][SemStamp.sampling_lsh_utils][INFO] - Accept Mask: tensor([1, 4], device='cuda:0')
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 121.53it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 141.68it/s]
[2024-05-22 13:21:05,995][SemStamp.sampling_lsh_utils][INFO] - LSH Candidate: 5
[2024-05-22 13:21:05,995][SemStamp.sampling_lsh_utils][INFO] - Candidate text is doesn't fall into the correct place in the embedding space.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[2024-05-22 13:21:10,557][SemStamp.sampling_lsh_utils][INFO] - Candidate text: 

The concept of power is a central theme in J.R.R. Tolkien's "The Lord of the Rings" series, where it plays a significant role in shaping the motivations, actions, and outcomes for many of its characters. Power
[2024-05-22 13:21:10,558][SemStamp.sampling_lsh_utils][INFO] - Accept Mask: tensor([1, 4], device='cuda:0')
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 105.20it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 126.26it/s]
[2024-05-22 13:21:10,581][SemStamp.sampling_lsh_utils][INFO] - LSH Candidate: 5
[2024-05-22 13:21:10,581][SemStamp.sampling_lsh_utils][INFO] - Candidate text is doesn't fall into the correct place in the embedding space.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[2024-05-22 13:21:14,601][SemStamp.sampling_lsh_utils][INFO] - Candidate text: 

The concept of power is a fundamental theme woven throughout J.R.R. Tolkien's "The Lord of the Rings" series, influencing the motivations, decisions, and development of numerous characters. The
[2024-05-22 13:21:14,602][SemStamp.sampling_lsh_utils][INFO] - Accept Mask: tensor([1, 4], device='cuda:0')
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 123.07it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 136.60it/s]
[2024-05-22 13:21:14,623][SemStamp.sampling_lsh_utils][INFO] - LSH Candidate: 5
[2024-05-22 13:21:14,624][SemStamp.sampling_lsh_utils][INFO] - Candidate text is doesn't fall into the correct place in the embedding space.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[2024-05-22 13:21:18,849][SemStamp.sampling_lsh_utils][INFO] - Candidate text: 

The concept of power is an intricate and dominant theme throughout J.R.R. Tolkien's "The Lord of the Rings" series, influencing the development of several characters and shaping the narrative as a whole. Power
[2024-05-22 13:21:18,850][SemStamp.sampling_lsh_utils][INFO] - Accept Mask: tensor([1, 4], device='cuda:0')
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 108.61it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 129.52it/s]
[2024-05-22 13:21:18,873][SemStamp.sampling_lsh_utils][INFO] - LSH Candidate: 5
[2024-05-22 13:21:18,873][SemStamp.sampling_lsh_utils][INFO] - Candidate text is doesn't fall into the correct place in the embedding space.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[2024-05-22 13:21:22,989][SemStamp.sampling_lsh_utils][INFO] - Candidate text: 

The concept of power is a central theme in J.R.R. Tolkien's "The Lord of the Rings" series, which explores the consequences of wielding and desiring power through its various characters. Power
[2024-05-22 13:21:22,990][SemStamp.sampling_lsh_utils][INFO] - Accept Mask: tensor([1, 4], device='cuda:0')
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 130.95it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 142.42it/s]
[2024-05-22 13:21:23,010][SemStamp.sampling_lsh_utils][INFO] - LSH Candidate: 5
[2024-05-22 13:21:23,010][SemStamp.sampling_lsh_utils][INFO] - Candidate text is doesn't fall into the correct place in the embedding space.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[2024-05-22 13:21:26,787][SemStamp.sampling_lsh_utils][INFO] - Candidate text: 

The concept of power is an essential theme woven throughout J.R.R. Tolkien's "The Lord of the Rings" series, influencing the motivations and behaviors of various characters. Power
[2024-05-22 13:21:26,788][SemStamp.sampling_lsh_utils][INFO] - Accept Mask: tensor([1, 4], device='cuda:0')
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 123.26it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 141.09it/s]
[2024-05-22 13:21:26,809][SemStamp.sampling_lsh_utils][INFO] - LSH Candidate: 5
[2024-05-22 13:21:26,809][SemStamp.sampling_lsh_utils][INFO] - Candidate text is doesn't fall into the correct place in the embedding space.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[2024-05-22 13:21:30,949][SemStamp.sampling_lsh_utils][INFO] - Candidate text: 

The concept of power is a crucial element in J.R.R. Tolkien's "The Lord of the Rings" series, as it shapes the motivations, relationships, and actions of the characters throughout the story. Power
[2024-05-22 13:21:30,949][SemStamp.sampling_lsh_utils][INFO] - Accept Mask: tensor([1, 4], device='cuda:0')
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 108.20it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 127.06it/s]
[2024-05-22 13:21:30,972][SemStamp.sampling_lsh_utils][INFO] - LSH Candidate: 5
[2024-05-22 13:21:30,972][SemStamp.sampling_lsh_utils][INFO] - Candidate text is doesn't fall into the correct place in the embedding space.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[2024-05-22 13:21:34,883][SemStamp.sampling_lsh_utils][INFO] - Candidate text: 

The concept of power is a central theme throughout J.R.R. Tolkien's "The Lord of the Rings" series, as it impacts the motivations, actions, and development of various characters. Power
[2024-05-22 13:21:34,884][SemStamp.sampling_lsh_utils][INFO] - Accept Mask: tensor([1, 4], device='cuda:0')
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 128.08it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 141.74it/s]
[2024-05-22 13:21:34,904][SemStamp.sampling_lsh_utils][INFO] - LSH Candidate: 5
[2024-05-22 13:21:34,904][SemStamp.sampling_lsh_utils][INFO] - Candidate text is doesn't fall into the correct place in the embedding space.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[2024-05-22 13:21:38,808][SemStamp.sampling_lsh_utils][INFO] - Candidate text: 

The concept of power is a central theme throughout J.R.R. Tolkien's "The Lord of the Rings" series, as it impacts the motivations, actions, and development of various characters. Power
[2024-05-22 13:21:38,808][SemStamp.sampling_lsh_utils][INFO] - Accept Mask: tensor([1, 4], device='cuda:0')
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 128.71it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 134.65it/s]
[2024-05-22 13:21:38,829][SemStamp.sampling_lsh_utils][INFO] - LSH Candidate: 5
[2024-05-22 13:21:38,829][SemStamp.sampling_lsh_utils][INFO] - Candidate text is doesn't fall into the correct place in the embedding space.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
[2024-05-22 13:21:43,331][SemStamp.sampling_lsh_utils][INFO] - Candidate text: 

The concept of power is a central theme in J.R.R. Tolkien's "The Lord of the Rings" series, where it plays a significant role in shaping the motivations, actions, and fates of the various characters. Power
[2024-05-22 13:21:43,331][SemStamp.sampling_lsh_utils][INFO] - Accept Mask: tensor([1, 4], device='cuda:0')
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 106.81it/s]
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 129.05it/s]
[2024-05-22 13:21:43,354][SemStamp.sampling_lsh_utils][INFO] - LSH Candidate: 5
[2024-05-22 13:21:43,354][SemStamp.sampling_lsh_utils][INFO] - Candidate text is doesn't fall into the correct place in the embedding space.
The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.
Traceback (most recent call last):
  File "/local1/borito1907/impossibility-watermark/watermarker_tester.py", line 39, in <module>
    test()
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
           ^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
            ^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
          ^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/impossibility-watermark/watermarker_tester.py", line 29, in test
    watermarked_text = watermarker.generate(prompt)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/impossibility-watermark/watermarker.py", line 50, in generate
    completion = self.generate_watermarked_outputs(prompt)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/impossibility-watermark/semstamp.py", line 77, in generate_watermarked_outputs
    return self._lsh_generate_watermarked_outputs(prompt)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/impossibility-watermark/semstamp.py", line 87, in _lsh_generate_watermarked_outputs
    response = lsh_reject_completion(
               ^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/impossibility-watermark/SemStamp/sampling_lsh_utils.py", line 116, in lsh_reject_completion
    outputs = model.generate(text_ids, gen_config, **generator_kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/transformers/generation/utils.py", line 1777, in generate
    return self.sample(
           ^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/transformers/generation/utils.py", line 2874, in sample
    outputs = self(
              ^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/transformers/models/mixtral/modeling_mixtral.py", line 1317, in forward
    outputs = self.model(
              ^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/transformers/models/mixtral/modeling_mixtral.py", line 1185, in forward
    layer_outputs = decoder_layer(
                    ^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/transformers/models/mixtral/modeling_mixtral.py", line 904, in forward
    hidden_states, router_logits = self.block_sparse_moe(hidden_states)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/transformers/models/mixtral/modeling_mixtral.py", line 820, in forward
    expert_layer = self.experts[expert_idx]
                   ~~~~~~~~~~~~^^^^^^^^^^^^
  File "/local1/borito1907/anaconda3/envs/watermark/lib/python3.12/site-packages/torch/nn/modules/container.py", line 290, in __getitem__
    @_copy_to_script_wrapper

KeyboardInterrupt
